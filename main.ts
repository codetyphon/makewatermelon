const imgs:Image[]=[
    img`
        . . a a a a . .
        . a a a a a a .
        a a a a a a a a
        a a a a a a a a
        a a a a a a a a
        a a a a a a a a
        . a a a a a a .
        . . a a a a . .
    `,
    img`
        . . . 2 2 2 2 2 2 . . .
        . . 2 2 2 2 2 2 2 2 . .
        . 2 2 2 2 2 2 2 2 2 2 .
        2 2 2 2 2 2 2 2 2 2 2 2
        2 2 2 2 2 2 2 2 2 2 2 2
        2 2 2 2 2 2 2 2 2 2 2 2
        2 2 2 2 2 2 2 2 2 2 2 2
        2 2 2 2 2 2 2 2 2 2 2 2
        2 2 2 2 2 2 2 2 2 2 2 2
        . 2 2 2 2 2 2 2 2 2 2 .
        . . 2 2 2 2 2 2 2 2 . .
        . . . 2 2 2 2 2 2 . . .
    `,
    img`
        ......444444......
        ...444444444444...
        ..44441444441144..
        .4444411444414444.
        .4444441144114444.
        .4444444141144444.
        444444441144444444
        444444411444444444
        411111114111444444
        444444411141114444
        444444114144441144
        444441144114444114
        .4444144441444444.
        .4441444441444444.
        .4444444441144444.
        ..44444444414444..
        ...444444444444...
        ......444444......
    `,
    img`
        .......111111111........
        ......115555555111......
        ....1115555555555111....
        ...115155555555555111...
        ..11551555555555515511..
        ..155511555555551155511.
        .1155551155555551555551.
        115555551555555115555511
        155555551155555155555551
        155555555115551555555551
        155555555515511555555551
        111111111111115551111111
        155555555551111115555551
        155555555511115555555551
        155555555115515555555551
        155555551155511555555511
        115555511555551155555511
        .15555115555555155555511
        .1155115555555511555511.
        ..111155555555551555111.
        ...115555555555511111...
        ....1115555555555111....
        ......111155555111......
        ........11111111........
    `,
    img`
        .........ffffffff...........
        .......fff777777fff.........
        .....fff77777777777ff.......
        ....ff77777777777777ff......
        ...ff77777777777777777ff....
        ..ff777777f777777777777ff...
        ..f77777777f7777777f7777ff..
        .ff7777777777777777ff7777ff.
        .f777777777777777777777777ff
        ff77f7777777777777777777777f
        f7777f777777777777777777777f
        f77777777777777777777777777f
        f77777777777111177777777f77f
        f7777777777111111177777f777f
        f77777777771111111777777777f
        f77777777771111111777777777f
        f77777777771111117777777777f
        f7777777777111111777777ff77f
        ff77f7777777711777777777777f
        .f7f77777777777777777777777f
        .f7777777777777777777f7777ff
        .ff7777777777777777777f777f.
        ..ff7777777777777777777777f.
        ...ff777f7777777777777777ff.
        ....ff7f77777777f7777777ff..
        .....ff7777777777f77777ff...
        ......fff777777777777fff....
        ........ffffffffffffff......
    `,
    img`
        ........444444444444444444......
        .....4445555555555555555544.....
        ...4455555555555555555555544....
        ..455555555555555555555555544...
        .4555555545555555555554445554...
        445555555445555555555544455544..
        4555551155455555555555444555544.
        45555511555555554555555555555544
        45555555555555555555555555555554
        45555555555555555555555555555554
        45555554555555555555555555555554
        45555555455555555555555555555554
        45555555555555555555555455555554
        45555555555555555555555555555554
        45544555555555555555555555555554
        45555555555555555555555555544554
        45555555555555555555555555555554
        45555555555555555555555555555554
        45555555554555555555555555555554
        44555555555555555555555555555554
        .4555555555555555555555554555554
        .4555555555555555555555555555554
        .4555555555555555555555555555554
        .4555555455554555554555555555544
        ..45555455555555555555555555554.
        ..45555555555555555555445555554.
        ...4555555555555555555445555544.
        ...445555555555555555555555544..
        ....4455555555555555555555544...
        .....4445555555555555555544.....
        ........444445555555554444......
        ............4444444444..........
    `,
    img`
        ...........777777777777777777...........
        .......77777777777777777777777..........
        ......77777222222222222222227777........
        .....7777222222222222222222222777.......
        ....777222222222222222222222222777......
        ...7772222222222222222222222222277......
        ...772222222222222222222222222222777....
        ..77222222222222222222222222222222777...
        ..72222222222222222f222222222222222777..
        .77222222222222222222222222f2222222277..
        7722222222222222222222222222222222222777
        77222222222f2222222222222222222222222277
        7222222222222222222222222222222222222277
        7222222222222222222222222222222222222277
        72222222222222222f2222222222222222222227
        7222222222222222222222222f22222f22222227
        72222222f2222222222222222222222222222227
        7222222222222222222222222222222222222227
        7222222222222222222222222222222222222227
        7222222222222222222222222222222222222227
        72222222222222222222222f2222222222222227
        7222222222222222222222222222222222222227
        7222222f222222f2222222222222222222222227
        7222222222222222222222222222f222f2222227
        7222222222222222222222222222222222222227
        7722222222222222222222222222222222222227
        772222222222222222f222222f22222222222277
        7722222222f2222222222222222222222222227.
        .77222222222222222222222222222222222227.
        .7772222222222222222222222222f222222227.
        ..7772222222222222222222222222222222277.
        ..7772222222222f2222222222222222222277..
        ...7772222222222222222f22222222222277...
        ....777222222222222222222222222222277...
        .....7772222222222222222222222222277....
        ......77722222222222222222222222277.....
        ........77722222222222222222222777......
        ..........77722222222222222227777.......
        ............777222222222222277..........
        ..............777777777777777...........
    `,
]
let hero:Sprite;

const make_by=(i:number)=>{
    hero = sprites.create(imgs[i])
    hero.setKind(SpriteKind.Player)
    hero.setStayInScreen(true)
    hero.setPosition(scene.screenWidth()/2, 0)
    hero.data={
        img_index:i
    }
}

const make_rand=()=>{
    const i:number = randint(0, 4)
    make_by(i)
}

const make_next=()=>{
    const i = hero.data.img_index
    if(i+1<=imgs.length-1){
        make_by(i+1)
    }else{
        make_by(1)
    }
}



controller.left.onEvent(ControllerButtonEvent.Pressed, function() {
    hero.setVelocity(-50, 0)
})
controller.right.onEvent(ControllerButtonEvent.Pressed, function() {
    hero.setVelocity(50, 0)
})
controller.left.onEvent(ControllerButtonEvent.Released, function() {
    hero.setVelocity(0, 50)
})
controller.right.onEvent(ControllerButtonEvent.Released, function() {
    hero.setVelocity(0, 50)
})

make_rand()

const copy_hero_to_food=()=>{
    let i = hero.image
    let food = sprites.create(i)
    food.setKind(SpriteKind.Food)
    food.x=hero.x
    food.y=hero.y
    hero.destroy()
    make_rand()
}

const copy_hero_to_next_food=()=>{
    let i = hero.image
    let food:Sprite;
    imgs.map((item,index)=>{
        if(i==item){
            if(index+1<=imgs.length-1){
                food = sprites.create(imgs[index+1])
            }else{
                food = sprites.create(imgs[index])
            }
        }
    })
    food.setKind(SpriteKind.Player)
    food.x=hero.x
    food.y=hero.y
    food.setVelocity(0, 50)
    food.setStayInScreen(true)
    hero.destroy()
    hero=food
}

game.onUpdate(function() {
    // if(hero.isHittingTile(CollisionDirection.Bottom)){
    //     hero.destroy()
    // }
    if(hero.y>=scene.screenHeight()-hero.height/2){
        copy_hero_to_food()
    }
})



sprites.onOverlap(SpriteKind.Player, SpriteKind.Food, function(hero: Sprite, food: Sprite) {
    if(hero.image==food.image){
        info.changeScoreBy(1)
        copy_hero_to_next_food()
        food.destroy()
        hero.destroy()
    }else{
        copy_hero_to_food()
    }
})


